name: publication

on:
  push:
    branches:
      # Host publications on branch 'main' only
      - main
    paths:
      # Append publications
      - publication/joss/**
      # Include workflow files
      - .github/workflows/publication.yml

jobs:
  joss:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Build draft PDF
        uses: openjournals/openjournals-draft-action@master
        with:
          journal: joss
          # Set input path to the draft file 'paper.md' within the repo.
          paper-path: publication/joss/paper.md

      - name: Upload draft PDF
        uses: actions/upload-artifact@v1
        with:
          name: paper
          # Set output path to the PDF file 'paper.pdf', which should be
          # in the same directory as the draft .md file and is
          # where Pandoc writes the compiled PDF.
          path: publication/joss/paper.pdf
